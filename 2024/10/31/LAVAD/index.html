<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>LAVAD | ZZ's Oasis</title><meta name="author" content="Zlatan"><meta name="copyright" content="Zlatan"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="利用LLM实现无需训练的视频异常检测">
<meta property="og:type" content="article">
<meta property="og:title" content="LAVAD">
<meta property="og:url" content="https://blog.zlatanzz.online/2024/10/31/LAVAD/index.html">
<meta property="og:site_name" content="ZZ&#39;s Oasis">
<meta property="og:description" content="利用LLM实现无需训练的视频异常检测">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog.zlatanzz.online/img/album/p10.webp">
<meta property="article:published_time" content="2024-10-31T07:32:44.323Z">
<meta property="article:modified_time" content="2024-10-31T07:50:00.000Z">
<meta property="article:author" content="Zlatan">
<meta property="article:tag" content="大模型">
<meta property="article:tag" content="视频异常检测">
<meta property="article:tag" content="CVPR">
<meta property="article:tag" content="计算机视觉">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.zlatanzz.online/img/album/p10.webp"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.zlatanzz.online/2024/10/31/LAVAD/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        if (name && globalFn[key][name]) return
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?7fca0b1d0b8e5975cbf47740ff1c8805";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
btf.addGlobalFn('pjaxComplete', () => {
  _hmt.push(['_trackPageview',window.location.pathname])
}, 'baidu_analytics')
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":5,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":150,"languages":{"author":"作者: Zlatan","link":"链接: ","source":"来源: ZZ's Oasis","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'null',
  Snackbar: {"chs_to_cht":"已切换为繁体中文","cht_to_chs":"已切换为简体中文","day_to_night":"已切换为深色模式","night_to_day":"已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-right"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'LAVAD',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-10-31 15:50:00'
}</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><!-- hexo injector head_end start --><link rel="stylesheet" href="/css/cate_bottom.css"><link rel="stylesheet" href="https://www.fomal.cc/static/css/runtime.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/p5.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/head_img.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">5</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/album/p10.webp);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">ZZ's Oasis</span></a><a class="nav-page-title" href="/"><span class="site-name">LAVAD</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">LAVAD</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon fas fa-history"></i><span class="post-meta-label">更新于</span><time datetime="2024-10-31T07:50:00.000Z" title="更新于 2024-10-31 15:50:00">2024-10-31</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Research/">Research</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">6.7k</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2024/10/31/LAVAD/#post-comment"><span class="gitalk-comment-count"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1>LAVAD</h1>
<p><strong>Harnessing Large Language Models for Training-free Video Anomaly Detection</strong></p>
<h2 id="Abstract">Abstract</h2>
<h3 id="背景">背景</h3>
<p>视频异常检测（VAD）旨在从时间上定位视频中的异常事件。现有的工作主要依靠训练深度模型来学习正态分布，无论是视频级监督、一类监督还是在无监督环境中。</p>
<p>基于训练的方法往往是特定于领域的，因此实际部署的成本很高，因为任何领域的变化都将涉及数据收集和模型训练。</p>
<h3 id="本文工作">本文工作</h3>
<p>在本文中，我们从根本上背离了之前的努力，并提出了基于语言的 VAD (LAVAD)，这是一种以新颖的、免训练范式解决 VAD 的方法，利用了预训练的<strong>大语言模型 (LLM) <strong>和</strong>现有视觉语言模型的功能（VLM）</strong>。</p>
<ul>
<li>
<p>我们利用基于 VLM 的字幕模型为任何测试视频的每一帧生成文本描述。通过文本场景描述，我们设计了一种提示机制来解锁 LLM 在<strong>时间聚合和异常分数估计</strong>方面的能力，将 LLM 转变为有效的视频异常检测器。</p>
</li>
<li>
<p>我们进一步利用模态对齐的 VLM，并提出基于<strong>跨模态相似性</strong>的有效技术，用于清理噪声字幕并细化基于 LLM 的异常分数。</p>
</li>
</ul>
<h3 id="实验结果">实验结果</h3>
<p>LAVAD在UCF-Crime和XD-Violence数据集上的性能超过了现有的无监督和单类方法，表明其在没有训练和数据收集的情况下也能实现有效的异常检测。</p>
<h2 id="1-Introduction">1. Introduction</h2>
<h3 id="1-1-VAD定义与挑战">1.1 VAD定义与挑战</h3>
<ul>
<li>
<p>**定义：**视频异常检测 (VAD) 旨在从时间上定位给定视频中明显偏离正常模式的事件，即异常事件。</p>
</li>
<li>
<p><strong>挑战：<strong>VAD 具有挑战性，因为异常通常是</strong>未定义的并且依赖于上下文</strong>，并且它们很少在现实世界中发生。</p>
</li>
</ul>
<h3 id="1-2-现有方法与挑战">1.2 现有方法与挑战</h3>
<p>VAD被视为<strong>分布外检测（out-of -distribution detection）</strong></p>
<p>并使用不同监督级别的训练数据来学习<strong>正态分布(normal distribution)</strong></p>
<ul>
<li>
<p><strong>完全监督方法（Fully-supervised methods）</strong>：需要在帧级别提供正常和异常视频的标签。这种方法能够提供精确的检测结果，但由于视频标注成本高昂，应用受限。</p>
</li>
<li>
<p><strong>弱监督方法（Weakly-supervised methods）</strong>：仅在视频级别提供标签，即标注视频为整体的正常或异常。虽然标注成本较低，但弱监督方法往往不能精确定位帧级异常。</p>
</li>
<li>
<p><strong>单类学习方法（One-class methods）</strong>：这些方法只使用正常视频进行训练，在训练过程中假设所有的训练视频都是正常的。然而，这需要在数据收集时严格确保所有视频确实是正常的，这样才能保证模型的有效性。</p>
</li>
<li>
<p><strong>无监督方法（Unsupervised methods）</strong>：这些方法不需要任何标签，假设训练数据中包含正常和异常视频，并使用生成模型来捕捉正常视频的模式。然而，这种假设在实际应用中较为脆弱，往往需要人工干预来保证模型的效果。</p>
</li>
</ul>
<p>虽然更多的监督会带来更好的结果，但手动注释的成本却令人望而却步。另一方面，无监督方法假设异常视频构成训练数据的某一部分，这在没有人工干预的实践中是一个脆弱的假设。</p>
<h3 id="1-3-现有方法的普遍问题">1.3. 现有方法的普遍问题</h3>
<p>所有现有的VAD方法都有一个共同的限制，即它们<strong>依赖于训练过程</strong>，这带来了一些关键问题：</p>
<ul>
<li><strong>泛化性差</strong>：由于VAD模型通常在特定的数据集上进行训练，它们在不同的场景中（例如白天和夜晚的变化）表现可能不尽如人意。模型在新的场景中常常需要重新进行训练，这增加了部署的成本。</li>
<li><strong>数据收集困难</strong>：特别是在涉及隐私问题的领域（例如视频监控）中，获取足够的数据进行训练非常困难。此外，标注视频中的异常事件也需要大量的人力资源和时间。</li>
</ul>
<p><strong>开发一种免训练的VAD方法</strong></p>
<h3 id="1-4-作者提出的方法：LAVAD">1.4. 作者提出的方法：LAVAD</h3>
<p>为了应对上述挑战，作者提出了一种新的视频异常检测方法，称为<strong>LAVAD（Language-based Video Anomaly Detection）</strong>，这是一个<strong>基于语言的大型预训练模型</strong>的新方法。LAVAD完全不依赖训练过程，而是通过结合现有的**视觉语言模型（VLMs）<strong>和</strong>大语言模型（LLMs）**来检测视频中的异常事件。该方法联合利用预训练的 VLM 和 LLM 进行 VAD。</p>
<p>具体来说，LAVAD的工作流程如下：</p>
<ol>
<li><strong>生成文本描述</strong>：使用VLM模型为每一帧视频生成文本描述（caption）。这一步骤可以利用现成的VLM来捕捉帧中的视觉信息并将其转化为自然语言描述。</li>
<li><strong>异常检测</strong>：基于生成的文本描述，LAVAD设计了一种<strong>提示机制</strong>，通过提示（prompts）大语言模型（LLMs）来对这些描述进行时间聚合，并为每一帧生成异常分数（anomaly score）。大语言模型通过聚合帧级信息，推测出视频中帧的异常性，从而实现异常检测。</li>
<li><strong>优化与增强</strong>：作者进一步利用模态对齐的VLMs提出了一种基于跨模态相似性的技术来<strong>清理噪声描述</strong>，并通过语义相似的时间窗口聚合异常分数，进一步提升检测性能。</li>
</ol>
<h3 id="1-5-作者贡献">1.5 作者贡献</h3>
<ul>
<li>
<p>首次研究了<strong>无训练的视频异常检测</strong>问题，强调其在数据收集困难或无法进行标注的实际场景中的重要性。</p>
</li>
<li>
<p>提出了<strong>LAVAD</strong>，这是第一个基于大语言模型的<strong>训练无关</strong>的VAD方法，利用场景描述来检测异常。</p>
</li>
<li>
<p>引入了<strong>基于跨模态相似性</strong>的技术，解决了噪声描述问题，并优化了基于LLM的异常打分，显著提升了检测性能。</p>
</li>
</ul>
<p>实验表明，LAVAD在不使用任务特定的监督和不进行训练的情况下，取得了与无监督和单类VAD方法相媲美的结果，为未来的VAD研究开辟了新的视角。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/LAVAD.assets/image-20241012092427308.png" alt="image-20241012092427308"></p>
<blockquote>
<p><strong>图1</strong>我们介绍了第一个用于视频异常检测( VAD )的免训练方法，该方法不同于现有的基于ALL训练的、不同监督程度的方法。我们的方案LAVAD利用模态对齐的视觉-语言模型( VLMs )来查询和增强大型语言模型( LLMs )产生的异常分数。</p>
</blockquote>
<h2 id="2-相关工作（Related-Work）">2. 相关工作（Related Work）</h2>
<h3 id="2-1-VAD-Video-Anomaly-Detection">2.1 VAD(Video Anomaly Detection)</h3>
<p>作者首先对视频异常检测领域的现有工作进行了分类，总结了不同类型的VAD方法。现有的VAD方法根据监督程度可以分为四类<strong>监督，弱监督，单类分类和无监督</strong>。：</p>
<ul>
<li><strong>完全监督方法（Fully-supervised VAD）</strong>：完全监督方法使用帧级标签来区分正常和异常帧。例如，某些方法使用3D卷积神经网络（3D CNNs）提取视频的时空特征，并通过帧级标注来训练模型。然而，完全监督的方式在实际应用中较少，因为标注每一帧的正常与异常需要巨大的人工成本。</li>
<li><strong>弱监督方法（Weakly-supervised VAD）</strong>：弱监督方法仅使用视频级别的标签。视频被标记为“异常”是基于视频中的某些帧可能包含异常事件。这类方法通常使用多实例学习（MIL）损失函数来优化模型，结合3D卷积神经网络提取特征。这类方法的优点在于标注成本相对较低，虽然不能精确定位帧级别的异常，但它们更适合实际操作中的大规模数据。</li>
<li><strong>单类分类方法（One-class VAD）</strong>：单类分类方法只使用正常视频进行训练，训练目标是学习正常行为的模式，以便检测在测试时与之不同的异常行为。这类方法的一个缺点是，虽然训练数据是正常的，但需要进行手动验证以确保收集到的数据都是正常的。例如考虑生成模型或伪监督方法，其中伪异常实例由正常训练数据合成</li>
<li><strong>无监督方法（Unsupervised VAD）</strong>：无监督方法不依赖于预定义的标签，通常假设大多数视频是正常的，而异常仅在少数视频中出现。这类方法通常使用生成模型来捕捉正常视频的模式。例如，生成对抗网络（GANs）和自编码器经常用于重建正常数据，并根据重建误差检测异常。<u>(特别地，生成式协作学习( GCL ) 采用交替训练：一个自动编码器重构输入特征，来自重构误差的伪标注引导一个判别器。)</u>然而，这类方法存在一定风险，因为如果异常视频的数量过多，模型可能无法学到有效的正常模式。</li>
</ul>
<p>使用扩散模型从含噪特征中重建原始数据分布，根据去噪和原始样本之间的重建误差计算异常分数。其他方法从OneClassSVM和孤立森林生成的一组伪标注中训练一个回归器网络。</p>
<h3 id="2-2-LLMs-for-VAD">2.2 LLMs for VAD</h3>
<p>最近，大语言模型（LLMs）在各种视觉异常检测领域中得到了探索。作者回顾了几项与LLMs相关的工作：</p>
<ul>
<li><strong>视觉语言模型在VAD中的应用</strong>：已有研究尝试结合视觉语言模型（VLMs）和LLMs进行视觉异常检测。例如，Kim等人提出了一种无监督方法，利用VLMs检测图像中的异常，而ChatGPT等LLMs则用于生成正常和异常元素的文本描述。尽管该方法结合了VLMs和LLMs，但仍需要通过人工干预来优化LLM的输出，并需要进一步的训练以适应特定应用场景。</li>
<li><strong>LLMs在特定应用中的使用</strong>：作者还指出，其他研究在机器人或工业应用中利用LLMs进行空间异常检测。然而，这些方法主要集中在静态图像的异常检测，且通常需要进一步的任务特定训练来提高模型性能。</li>
</ul>
<p>与现有工作不同，LAVAD方法不仅结合了LLMs和VLMs，还首次在视频异常检测中提出了<strong>完全训练无关的框架</strong>，不需要额外的数据收集或模型训练。</p>
<h2 id="3-Training-Free-VAD-无训练VAD">3. Training-Free VAD(无训练VAD)</h2>
<p>在这一部分中，我们首先提出了了VAD问题和提出的免训练设置( Sec.3.1 )。然后，我们分析了LLMs在视频帧中评分异常的能力(第3.2节)。最后，我们描述了LAVAD，我们提出的VAD方法(见3.3节)。</p>
<h3 id="3-1-问题定义（Problem-Formulation）">3.1 问题定义（Problem Formulation）</h3>
<p>在这一部分，作者首先正式定义了视频异常检测任务。给定一个包含 M帧的测试视频$$V=[I_1,I_2,…,I_M]$$，传统的VAD方法旨在学习一个模型 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span>，该模型能够为每一帧 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">I_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>分配一个分数，判断其是否为异常，异常分数介于0到1之间（0表示正常，1表示异常）。这些传统方法通常需要使用一个训练集 D，其中每个视频 V都带有标签 y，标签的形式取决于监督的级别（帧级别标签、视频级别标签或无标签等）。</p>
<p>然而，LAVAD与传统方法不同，它不依赖训练数据。在无训练设置下，LAVAD旨在通过预训练的模型在推理过程中直接估计每一帧的异常分数，而<strong>无需进行任何训练或微调</strong>。这种无训练的设置使得LAVAD可以在无需数据标注和模型训练的情况下应用于实际场景。</p>
<h3 id="3-2-LLMs4VAD-good">3.2 LLMs4VAD good?</h3>
<p>在这一部分中，作者探讨了大语言模型（LLMs）在视频异常检测中的潜力。具体而言，LAVAD利用一个<strong>预训练的视觉语言模型（VLM）</strong>，如<strong>BLIP-2</strong>，来生成每一帧的视频描述（caption）。这些文本描述为大语言模型提供了输入，以便生成每帧的异常分数。</p>
<p><strong>核心步骤</strong>：</p>
<ol>
<li><strong>生成文本描述</strong>：首先，使用VLM（如BLIP-2）为每帧 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">I_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>生成一个文本描述 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">C_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。这些描述为后续的大语言模型操作提供了基础信息。</li>
<li><strong>异常分数估计</strong>：接下来，作者将异常分数估计任务视为一个分类任务，利用大语言模型（LLM）对生成的描述进行处理。通过给LLM一个特定的提示（prompt），询问其如何对该场景进行异常评分（0为正常，1为异常），从而获取异常分数。</li>
</ol>
<p>异常分数的计算公式为：</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><msub><mi mathvariant="normal">Φ</mi><mrow><mi>L</mi><mi>L</mi><mi>M</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>P</mi><mi>C</mi></msub><mo>∘</mo><msub><mi>P</mi><mi>F</mi></msub><mo>∘</mo><msub><mi mathvariant="normal">Φ</mi><mi>C</mi></msub><mo stretchy="false">(</mo><msub><mi>I</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a_i=Φ_{LLM}(P_C∘P_F∘Φ_C(I_i))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">LL</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span></span></span></span></p>
<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Φ</mi><mrow><mi>L</mi><mi>L</mi><mi>M</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Φ_{LLM}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">LL</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是大语言模型，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Φ</mi><mi>C</mi></msub></mrow><annotation encoding="application/x-tex">Φ_C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是用于生成描述的视觉语言模型，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>C</mi></msub></mrow><annotation encoding="application/x-tex">P_C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是提供上下文的提示，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>F</mi></msub></mrow><annotation encoding="application/x-tex">P_F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是要求LLM输出分数的格式提示，∘ 表示文本的连接操作。</p>
<p><strong>实验分析</strong>： 为了验证LLMs的能力，作者在UCF-Crime数据集上测试了不同版本的BLIP-2模型，并使用了不同的LLMs（如Llama和Mistral）来生成异常分数。实验结果表明，尽管LLMs能够显著优于随机评分，但其性能仍不及无监督方法。作者认为，LLMs的表现受到了两个方面的限制：</p>
<ul>
<li><strong>帧级描述的噪声</strong>：生成的描述可能存在错误或不完整，导致异常分数不准确如图三。</li>
<li><strong>缺乏场景的全局信息</strong>：单帧的描述无法捕捉视频的动态信息（缺乏上下文信息），而视频中的场景动态对异常检测至关重要。</li>
</ul>
<p>因此，作者接下来提出了如何通过LAVAD的方法解决这些问题。该方法利用LLMs和模态对齐的VLMs进行异常评分。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/LAVAD.assets/image-20241012095920776.png" alt="image-20241012095920776"></p>
<blockquote>
<p>**图二：**通过在UCF - Crime测试集上查询LLMs对来自不同字幕模型的视频帧的文本描述，绘制VAD性能的条形图( AUC ROC )。不同的线条对应着标题模型BLIP - 2的不同变体，而不同的颜色则表示两个不同的LLMs 。作为参考，我们还绘制了性能最好的无监督方法在红色虚线中的表现，以及随机分类器在灰色虚线中的表现。</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/LAVAD.assets/image-20241012100733926.png" alt="image-20241012100733926"></p>
<blockquote>
<p>**图三：**Llama 对UCF - Crime中的视频Shooting033预测了随时间变化的异常分数。我们突出一些样本帧及其相关的BLIP -  2标题，以证明标题可以是语义噪声或不正确的(红色包围盒用于异常预测,蓝色包围盒用于正常预测)。<strong>突出了实际异常</strong>。特别地，由于LLM给出的低异常分数，由蓝色边界框围成的帧的描述未能准确地表示视觉内容，从而导致错误的分类。</p>
</blockquote>
<h3 id="3-3-LAVAD：LAnguage-based-VAD">3.3 LAVAD：LAnguage-based VAD</h3>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/LAVAD.assets/image-20241012101749156.png" alt="image-20241012101749156"></p>
<blockquote>
<p>**图四：**本文提出的用于解决免训练VAD的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>A</mi><mi>V</mi><mi>A</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">LAVAD</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>的体系结构。对于每个测试视频<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span>，我们首先使用字幕模型为每一帧<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">I_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>∈<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span>生成一个字幕<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">C_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，形成字幕序列<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>。我们的图像-文本字幕清洗组件基于跨模态相似度来处理噪声和错误的原始字幕。我们将原始字幕替换为字幕<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><msub><mi>C</mi><mi>i</mi></msub><mo>~</mo></mover><mo>∈</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">\tilde{C_i}∈C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0702em;vertical-align:-0.15em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>，其文本embedding  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ξ</mi><mi>T</mi></msub><mo stretchy="false">(</mo><mover accent="true"><msub><mi>C</mi><mi>i</mi></msub><mo>~</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\xi_T ( \tilde{C _i })</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1702em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.046em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mclose">)</span></span></span></span>与图像embedding   <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ξ</mi><mi>I</mi></msub><mo stretchy="false">(</mo><msub><mi>I</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\xi_I ( I_i )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.046em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>最对齐，从而得到干净的字幕序列<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>C</mi><mo>~</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{C}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9202em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">~</span></span></span></span></span></span></span></span></span></span>。<strong>为了考虑场景上下文和动态性</strong>，基于LLM的Anomaly  Scoring组件通过促使LLM产生一个时间摘要<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">S_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，进一步聚合以每个<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">I_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为中心的时间窗口内的已清洗字幕，形成一个摘要序列S，然后查询LLM，根据每个帧的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">S_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为其提供一个异常分数，得到所有帧的初始异常分数a。最后，我们的Video - Text Score Refinement组件通过聚合以<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">I_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为中心的视频片段<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">V_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的表示<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ξ</mi><mi>V</mi></msub><mo stretchy="false">(</mo><msub><mi>V</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\xi_V ( V_i  )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.046em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>与摘要的文本嵌入大部分对齐的帧的初始异常分数来细化每个<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，从而得到最终的异常分数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>a</mi><mo>~</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">a</span></span><span style="top:-3.35em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">~</span></span></span></span></span></span></span></span></span></span>，用于检测视频中的异常(异常帧被突出显示)。</p>
</blockquote>
<p>LAVAD将VAD函数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span>分解为五个元素(见图4)。与预研究一样，前两个是在语言空间T中，将图像映射为文本描述的字幕模块<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Φ</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">Φ C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Φ</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Φ</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">Φ C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Φ</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo>→</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">I→T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span>，以及由语言查询生成文本的LLM <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Φ</mi><mi>L</mi><mi>L</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">Φ LLM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Φ</span><span class="mord mathnormal">LL</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span> ，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Φ</mi><mi>L</mi><mi>L</mi><mi>M</mi><mtext>：</mtext><mi>T</mi><mo>→</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">Φ LLM：T→T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Φ</span><span class="mord mathnormal">LL</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord cjk_fallback">：</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span>。其他元素包括三个编码器，将输入表示映射到共享的潜在空间Z。具体来说，我们有图像编码器 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ξ</mi><mi>I</mi></msub><mtext>：</mtext><mi>I</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">\xi_I：I→Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.046em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">：</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span>，文本编码器 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ξ</mi><mi>T</mi></msub><mtext>：</mtext><mi>T</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">\xi_T：T→Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.046em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">：</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span> 和视频编码器 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ξ</mi><mi>V</mi></msub><mtext>：</mtext><mi>V</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">\xi_V：V→Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.046em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">：</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span>。注意的是，所有的五个元素都只涉及现成的冷冻模型。</p>
<h4 id="3-3-1-图像-文本描述清理（Image-Text-Caption-Cleaning）">3.3.1. <strong>图像-文本描述清理</strong>（Image-Text Caption Cleaning）</h4>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/LAVAD.assets/image-20241012113717145.png" alt="image-20241012113717145"></p>
<h4 id="3-3-2-LLM-based-异常打分">3.3.2 LLM-based 异常打分</h4>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/LAVAD.assets/image-20241012151705243.png" alt="image-20241012151705243"></p>
<h4 id="3-3-3-视频——文本分数优化（Video-Text-Score-Refinement）">3.3.3 视频——文本分数优化（Video-Text Score Refinement）</h4>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/LAVAD.assets/image-20241012163508741.png" alt="image-20241012163508741"></p>
<p>旨在通过利用视频片段与文本描述的跨模态相似性，进一步优化每一帧的异常分数。这个步骤的目的是解决初始异常分数可能因帧级信息不足或不准确而存在的问题。通过这种优化，LAVAD 能够充分利用视频的全局信息，提高视频异常检测的鲁棒性和准确性。</p>
<h2 id="4-Experiments-实验">4. Experiments(实验)</h2>
<p>我们在两个数据集上验证了我们的免训练算法LAVAD，我们进行了广泛的消融研究，以证明我们的主要设计选择是关于拟议的组件、快速并与在不同监督水平下训练的最先进的VAD方法以及免训练的基线进行了比较、设计和评分细化。</p>
<h4 id="4-0-1-数据集（Datasets）">4.0.1  <strong>数据集</strong>（Datasets）</h4>
<p>LAVAD 在两个大规模数据集上进行了实验验证：</p>
<ul>
<li><strong>UCF-Crime</strong>：这是一个包含 1900 段未剪辑监控视频的大型数据集，涵盖 13 种异常事件，如打架、偷窃等。该数据集被分为训练集（800 段正常视频和 810 段异常视频）和测试集（150 段正常视频和 140 段异常视频）。</li>
<li><strong>XD-Violence</strong>：这是另一个大规模的数据集，包含 4754 段带有音频信号的视频，捕捉了 6 类暴力相关的异常事件。视频来自电影和 YouTube，具有更多元的内容。</li>
</ul>
<h4 id="4-0-2-性能指标（Performance-Metrics）">4.0.2  <strong>性能指标</strong>（Performance Metrics）</h4>
<p>为了评估视频异常检测性能，实验采用了两个主要指标：</p>
<ul>
<li><strong>AUC ROC（曲线下面积）</strong>：帧级别的接收者操作特性曲线下的面积。该指标与异常检测的阈值选择无关，是衡量检测任务的标准方法。</li>
<li><strong>AP（平均精度）</strong>：这是针对 XD-Violence 数据集的指标，表示帧级别的精度-召回曲线下的面积，通常用于评价检测任务的精准度和召回率。</li>
</ul>
<blockquote>
<p>AUC 是 ROC 曲线下面积的大小，用于定量衡量模型的分类能力。AUC 的取值范围在 0 到 1 之间，代表了模型性能的好坏：</p>
</blockquote>
<ul>
<li><strong>AUC = 1</strong>：模型表现完美，能够在所有情况下正确区分正类和负类。</li>
<li><strong>AUC = 0.5</strong>：模型与随机猜测的效果相同，无法有效区分正类和负类。</li>
<li><strong>AUC &lt; 0.5</strong>：模型表现糟糕，反而在大多数情况下错误分类。</li>
</ul>
<blockquote>
<p>在视频异常检测任务中，AUC ROC 通常用于衡量模型在帧级别上的检测性能。具体来说，模型需要将每一帧视频分类为“正常”或“异常”，并计算出对应的异常分数。通过 ROC 曲线和 AUC，可以评估模型在不同阈值下对异常帧和正常帧的区分能力。AUC 值越高，表示模型在帧级别上检测异常的效果越好。</p>
</blockquote>
<h4 id="4-0-3-实现细节（Implementation-Details）">4.0.3  <strong>实现细节</strong>（Implementation Details）</h4>
<ul>
<li><strong>采样策略</strong>：为提高计算效率，LAVAD 对每个视频进行了每 16 帧采样一次，以减少冗余信息。</li>
<li><strong>模型选择</strong>：LAVAD 采用了 BLIP-2 作为生成文本描述的视觉语言模型（VLM），并使用了 Llama-2-13b-chat 作为大语言模型（LLM）。此外，还采用了 ImageBind 提供的多模态编码器用于视频-文本分数优化。时间窗口设置为 10 秒，并选取 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">K=10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span> 帧进行相似性计算。</li>
</ul>
<h3 id="4-1-与SOTA比较">4.1 与SOTA比较</h3>
<ul>
<li><strong>LLAVA-1.5 方法的比较</strong>：作为另一种训练无关的基线方法，LLAVA-1.5 直接使用大语言模型（LLM）生成每帧的异常分数，其性能比零样本的 VLM 方法要好，但仍然不如 LAVAD。这说明 LAVAD 中所采用的时间总结和异常分数优化过程，在提升视频异常检测性能方面起到了重要作用。</li>
</ul>
<h4 id="4-1-1-定性分析（Qualitative-Analysis）">4.1.1  <strong>定性分析（Qualitative Analysis）</strong></h4>
<p>除了定量比较之外，作者还展示了 LAVAD 方法的部分定性结果。实验中展示了 LAVAD 在 UCF-Crime 和 XD-Violence 数据集上对一些视频的检测结果：</p>
<ul>
<li><strong>异常视频</strong>：在异常视频中，LAVAD 能够准确捕捉到视频中的异常时刻，并通过生成的时间总结来解释这些异常行为。例如，在检测到打斗或暴力事件时，模型能够识别到特定的时间段，并且与视觉和文本信息一致。</li>
<li><strong>正常视频</strong>：在正常视频中，LAVAD 生成的异常分数保持较低，证明了模型能够有效地区分正常行为与异常行为。</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/LAVAD.assets/image-20241013103611847.png" alt="image-20241013103611847"></p>
<p>**图五：**我们展示了LAVAD在四个测试视频上获得的定性结果，包括UCF - Crime的两个视频(上排)和XD -  Violence的两个视频(下排)。对于每个视频，我们在我们的方法计算的帧上绘制异常分数。我们展示了一些关键帧和它们最匹配的时间摘要(正常帧预测的蓝色包围盒和异常帧预测的红色包围盒)，说明了预测的异常分数、视觉内容和描述之间的相关性。突出了地实异常。</p>
<h3 id="4-2-Ablation-study-消融研究">4.2 Ablation study(消融研究)</h3>
<h4 id="4-2-1-各组件的有效性实验">4.2.1 各组件的有效性实验</h4>
<p>这部分通过去除或修改LAVAD中的某些组件，来评估它们对视频异常检测性能的贡献。主要包括以下几个变体：</p>
<ul>
<li><strong>去掉图像-文本描述清理组件</strong>：仅使用原始的文本描述进行检测，结果显示异常检测性能降低了3.8%。</li>
<li><strong>不使用时间总结</strong>：只依赖清理后的文本描述，不考虑时间动态信息，性能下降7.58%，这说明时间总结对LLM异常评分有显著提升作用。</li>
<li><strong>不进行视频-文本评分优化</strong>：仅基于时间总结的初始异常得分，结果性能下降7.49%，表明视频-文本评分优化对于提高检测性能也起到了重要作用。</li>
</ul>
<p>总体来看，这部分的实验验证了LAVAD中每个组件（图像-文本描述清理、基于LLM的异常评分、视频-文本得分优化）的重要性和必要性。</p>
<h4 id="4-2-2-任务相关的上下文提示词实验：">4.2.2 <strong>任务相关的上下文提示词实验</strong>：</h4>
<p>这一部分探讨了在为LLM设计提示词（prompt）时，加入不同任务相关的先验信息（如异常检测背景、模拟执法场景）是否会对检测性能产生影响。实验结果表明：</p>
<ul>
<li>添加“犯罪活动”等先验信息对异常检测性能影响较小。</li>
<li>加入“执法机关”的模拟角色提示（例如“如果你是执法机关，你会如何评价这一场景？”）可以提升检测性能，增加了0.96%的AUC。</li>
<li>但当同时加入“犯罪活动”和“执法机关”两类提示词时，性能并未进一步提升，表明过于严格的提示可能限制了LLM检测更广泛异常的能力。</li>
</ul>
<h4 id="4-2-3-K值">4.2.3 K值</h4>
<p>这里的K值指的是在视频-文本得分优化步骤中，用于聚合异常得分的语义最相似帧的数量。实验结果显示，随着K值增加，VAD性能也提升，并且在K值达到9时性能趋于稳定。这表明考虑语义相似的帧对于生成更可靠的异常得分非常重要。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/LAVAD.assets/image-20241013110658775.png" alt="image-20241013110658775"></p>
<h2 id="5-总结（Conclusion）">5. 总结（Conclusion）</h2>
<h3 id="5-1-方法总结">5.1 方法总结</h3>
<p>LAVAD 是一种创新的无训练视频异常检测方法，它通过语言驱动的方式来估计异常得分，充分利用了预训练的大语言模型（LLMs）和视觉-语言模型（VLMs）。具体而言，LAVAD 采用了以下三大组件：</p>
<ul>
<li><strong>图像-文本相似性清理</strong>：用于清理由视频帧生成的噪声文本描述，从而提高文本描述的质量。</li>
<li><strong>基于LLM的异常评分</strong>：通过引入时间窗口，利用LLM生成的场景动态总结来估计异常得分。</li>
<li><strong>视频-文本评分优化</strong>：通过聚合语义上相似的帧来优化异常得分。</li>
</ul>
<h3 id="5-2-实验结果：">5.2 <strong>实验结果</strong>：</h3>
<p>LAVAD在两个视频异常检测数据集（UCF-Crime 和 XD-Violence）上的实验结果表明，在无监督和单类异常检测任务中，该方法的性能优于现有的训练基方法，并且无需进行模型训练或数据收集。实验还验证了该方法在真实世界应用中的潜力。</p>
<h3 id="5-3-未来工作展望：">5.3 <strong>未来工作展望</strong>：</h3>
<p>LAVAD 的成功为未来视频异常检测的研究提供了新的方向。由于该方法能够在没有训练和数据收集的情况下实现高效的异常检测，未来可以探索如何进一步扩展和改进这类无训练检测方法，以应对更多实际场景的挑战。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://blog.zlatanzz.online">Zlatan</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://blog.zlatanzz.online/2024/10/31/LAVAD/">https://blog.zlatanzz.online/2024/10/31/LAVAD/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://blog.zlatanzz.online" target="_blank">ZZ's Oasis</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%A4%A7%E6%A8%A1%E5%9E%8B/">大模型</a><a class="post-meta__tags" href="/tags/%E8%A7%86%E9%A2%91%E5%BC%82%E5%B8%B8%E6%A3%80%E6%B5%8B/">视频异常检测</a><a class="post-meta__tags" href="/tags/CVPR/">CVPR</a><a class="post-meta__tags" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/">计算机视觉</a></div><div class="post-share"><div class="social-share" data-image="/img/album/p10.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2024/10/31/Holmes-VAD/" title="Holmes-VAD"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/album/p5.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="fas fa-history fa-fw"></i> 2024-10-31</div><div class="info-item-2">Holmes-VAD</div></div><div class="info-2"><div class="info-item-1">利用MLLM实现视频异常检测的无偏性和可解释性</div></div></div></a><a class="pagination-related" href="/2024/10/31/MMGaitFormer/" title="MMGaitFormer"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/album/p1.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="fas fa-history fa-fw"></i> 2024-10-31</div><div class="info-item-2">MMGaitFormer</div></div><div class="info-2"><div class="info-item-1">融合时空特征的多模态步态识别</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/head_img.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Zlatan</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">5</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/zlatan-zzz"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/zlatan-zzz" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:1138492923@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">LAVAD</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Abstract"><span class="toc-text">Abstract</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%83%8C%E6%99%AF"><span class="toc-text">背景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%AC%E6%96%87%E5%B7%A5%E4%BD%9C"><span class="toc-text">本文工作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C"><span class="toc-text">实验结果</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Introduction"><span class="toc-text">1. Introduction</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-VAD%E5%AE%9A%E4%B9%89%E4%B8%8E%E6%8C%91%E6%88%98"><span class="toc-text">1.1 VAD定义与挑战</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E7%8E%B0%E6%9C%89%E6%96%B9%E6%B3%95%E4%B8%8E%E6%8C%91%E6%88%98"><span class="toc-text">1.2 现有方法与挑战</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E7%8E%B0%E6%9C%89%E6%96%B9%E6%B3%95%E7%9A%84%E6%99%AE%E9%81%8D%E9%97%AE%E9%A2%98"><span class="toc-text">1.3. 现有方法的普遍问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-%E4%BD%9C%E8%80%85%E6%8F%90%E5%87%BA%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%9ALAVAD"><span class="toc-text">1.4. 作者提出的方法：LAVAD</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-%E4%BD%9C%E8%80%85%E8%B4%A1%E7%8C%AE"><span class="toc-text">1.5 作者贡献</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E7%9B%B8%E5%85%B3%E5%B7%A5%E4%BD%9C%EF%BC%88Related-Work%EF%BC%89"><span class="toc-text">2. 相关工作（Related Work）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-VAD-Video-Anomaly-Detection"><span class="toc-text">2.1 VAD(Video Anomaly Detection)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-LLMs-for-VAD"><span class="toc-text">2.2 LLMs for VAD</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Training-Free-VAD-%E6%97%A0%E8%AE%AD%E7%BB%83VAD"><span class="toc-text">3. Training-Free VAD(无训练VAD)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E9%97%AE%E9%A2%98%E5%AE%9A%E4%B9%89%EF%BC%88Problem-Formulation%EF%BC%89"><span class="toc-text">3.1 问题定义（Problem Formulation）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-LLMs4VAD-good"><span class="toc-text">3.2 LLMs4VAD good?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-LAVAD%EF%BC%9ALAnguage-based-VAD"><span class="toc-text">3.3 LAVAD：LAnguage-based VAD</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-1-%E5%9B%BE%E5%83%8F-%E6%96%87%E6%9C%AC%E6%8F%8F%E8%BF%B0%E6%B8%85%E7%90%86%EF%BC%88Image-Text-Caption-Cleaning%EF%BC%89"><span class="toc-text">3.3.1. 图像-文本描述清理（Image-Text Caption Cleaning）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-2-LLM-based-%E5%BC%82%E5%B8%B8%E6%89%93%E5%88%86"><span class="toc-text">3.3.2 LLM-based 异常打分</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-3-%E8%A7%86%E9%A2%91%E2%80%94%E2%80%94%E6%96%87%E6%9C%AC%E5%88%86%E6%95%B0%E4%BC%98%E5%8C%96%EF%BC%88Video-Text-Score-Refinement%EF%BC%89"><span class="toc-text">3.3.3 视频——文本分数优化（Video-Text Score Refinement）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Experiments-%E5%AE%9E%E9%AA%8C"><span class="toc-text">4. Experiments(实验)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-0-1-%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%88Datasets%EF%BC%89"><span class="toc-text">4.0.1  数据集（Datasets）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-0-2-%E6%80%A7%E8%83%BD%E6%8C%87%E6%A0%87%EF%BC%88Performance-Metrics%EF%BC%89"><span class="toc-text">4.0.2  性能指标（Performance Metrics）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-0-3-%E5%AE%9E%E7%8E%B0%E7%BB%86%E8%8A%82%EF%BC%88Implementation-Details%EF%BC%89"><span class="toc-text">4.0.3  实现细节（Implementation Details）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E4%B8%8ESOTA%E6%AF%94%E8%BE%83"><span class="toc-text">4.1 与SOTA比较</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-1-%E5%AE%9A%E6%80%A7%E5%88%86%E6%9E%90%EF%BC%88Qualitative-Analysis%EF%BC%89"><span class="toc-text">4.1.1  定性分析（Qualitative Analysis）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-Ablation-study-%E6%B6%88%E8%9E%8D%E7%A0%94%E7%A9%B6"><span class="toc-text">4.2 Ablation study(消融研究)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-1-%E5%90%84%E7%BB%84%E4%BB%B6%E7%9A%84%E6%9C%89%E6%95%88%E6%80%A7%E5%AE%9E%E9%AA%8C"><span class="toc-text">4.2.1 各组件的有效性实验</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-2-%E4%BB%BB%E5%8A%A1%E7%9B%B8%E5%85%B3%E7%9A%84%E4%B8%8A%E4%B8%8B%E6%96%87%E6%8F%90%E7%A4%BA%E8%AF%8D%E5%AE%9E%E9%AA%8C%EF%BC%9A"><span class="toc-text">4.2.2 任务相关的上下文提示词实验：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-3-K%E5%80%BC"><span class="toc-text">4.2.3 K值</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E6%80%BB%E7%BB%93%EF%BC%88Conclusion%EF%BC%89"><span class="toc-text">5. 总结（Conclusion）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93"><span class="toc-text">5.1 方法总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C%EF%BC%9A"><span class="toc-text">5.2 实验结果：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E6%9C%AA%E6%9D%A5%E5%B7%A5%E4%BD%9C%E5%B1%95%E6%9C%9B%EF%BC%9A"><span class="toc-text">5.3 未来工作展望：</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/11/02/test/" title="测试_第一篇文章"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/album/p4.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="测试_第一篇文章"/></a><div class="content"><a class="title" href="/2024/11/02/test/" title="测试_第一篇文章">测试_第一篇文章</a><time datetime="2024-11-02T09:41:33.999Z" title="发表于 2024-11-02 17:41:33">2024-11-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/11/02/LeetCode/" title="LeetCode每日一题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/album/p21.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="LeetCode每日一题"/></a><div class="content"><a class="title" href="/2024/11/02/LeetCode/" title="LeetCode每日一题">LeetCode每日一题</a><time datetime="2024-11-02T09:35:20.544Z" title="发表于 2024-11-02 17:35:20">2024-11-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/31/MMGaitFormer/" title="MMGaitFormer"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/album/p1.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MMGaitFormer"/></a><div class="content"><a class="title" href="/2024/10/31/MMGaitFormer/" title="MMGaitFormer">MMGaitFormer</a><time datetime="2024-10-31T07:32:44.324Z" title="发表于 2024-10-31 15:32:44">2024-10-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/31/LAVAD/" title="LAVAD"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/album/p10.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="LAVAD"/></a><div class="content"><a class="title" href="/2024/10/31/LAVAD/" title="LAVAD">LAVAD</a><time datetime="2024-10-31T07:32:44.323Z" title="发表于 2024-10-31 15:32:44">2024-10-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/31/Holmes-VAD/" title="Holmes-VAD"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/album/p5.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Holmes-VAD"/></a><div class="content"><a class="title" href="/2024/10/31/Holmes-VAD/" title="Holmes-VAD">Holmes-VAD</a><time datetime="2024-10-31T07:32:44.320Z" title="发表于 2024-10-31 15:32:44">2024-10-31</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 By Zlatan</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://butterfly.js.org/">oasis</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>(() => {
  const panguFn = () => {
    if (typeof pangu === 'object') pangu.autoSpacingPage()
    else {
      btf.getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
        .then(() => {
          pangu.autoSpacingPage()
        })
    }
  }

  const panguInit = () => {
    if (false){
      GLOBAL_CONFIG_SITE.isPost && panguFn()
    } else {
      panguFn()
    }
  }

  btf.addGlobalFn('pjaxComplete', panguInit, 'pangu')
  document.addEventListener('DOMContentLoaded', panguInit)
})()</script><div class="js-pjax"><script>(async () => {
  const showKatex = () => {
    document.querySelectorAll('#article-container .katex').forEach(el => el.classList.add('katex-show'))
  }

  if (!window.katex_js_css) {
    window.katex_js_css = true
    await btf.getCSS('https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css')
    if (true) {
      await btf.getScript('https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js')
    }
  }

  showKatex()
})()</script><script>(() => {
  const initGitalk = () => {
    const gitalk = new Gitalk(Object.assign({
      clientID: 'Ov23liclyazaM6CUEQOg',
      clientSecret: 'c83a8ef88c812521fde490af8e6664fb57012b66',
      repo: 'zlatan-zzz.github.io',
      owner: 'zlatan-zzz',
      admin: ['zlatan-zzz'],
      id: 'e1a6ea39ae83f087b760d8f82116c394',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  const loadGitalk = async() => {
    if (typeof Gitalk === 'function') initGitalk()
    else {
      await btf.getCSS('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css')
      await btf.getScript('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js')
      initGitalk()
    }
  }
  
  const commentCount = n => {
    const isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
    if (isCommentCount) {
      isCommentCount.textContent= n
    }
  }

  if ('Gitalk' === 'Gitalk' || !false) {
    if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
    else loadGitalk()
  } else {
    window.loadOtherComment = loadGitalk
  }
})()</script></div><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><!-- hexo injector body_end start --><script data-pjax>
    function butterfly_categories_card_injector_config(){
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<style>li.categoryBar-list-item{width:32.3%;}.categoryBar-list{max-height: 190px;overflow:auto;}.categoryBar-list::-webkit-scrollbar{width:0!important}@media screen and (max-width: 650px){.categoryBar-list{max-height: 160px;}}</style><div class="recent-post-item" style="height:auto;width:100%;padding:0px;"><div id="categoryBar"><ul class="categoryBar-list"><li class="categoryBar-list-item" style="background:url(/img/p1.jpg);"> <a class="categoryBar-list-link" href="categories/Research/">Research</a><span class="categoryBar-list-count">3</span><span class="categoryBar-list-descr">Research</span></li><li class="categoryBar-list-item" style="background:url(/img/p2.jpg);"> <a class="categoryBar-list-link" href="categories/Technique/">Technique</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">Technique</span></li><li class="categoryBar-list-item" style="background:url(/img/p3.jpg);"> <a class="categoryBar-list-link" href="categories/Others/">Others</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">Others</span></li></ul></div></div>';
      console.log('已挂载butterfly_categories_card')
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      }
    if( document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    butterfly_categories_card_injector_config()
    }
  </script><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题版本Butterfly" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" data-title="本站采用多线部署，主线路托管于Vercel" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Vercel-brightgreen?style=flat&amp;logo=Vercel" alt=""/></a><a class="github-badge" target="_blank" href="https://dashboard.4everland.org/" style="margin-inline:5px" data-title="本站采用多线部署，备用线路托管于4EVERLAND" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-4EVERLAND-22DDDD?style=flat&amp;logo=IPFS" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></p>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="/js/runtime.js"></script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__bounceInRight');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '1s');
    arr[i].setAttribute('data-wow-offset', '100');
    arr[i].setAttribute('data-wow-iteration', '2');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__bounceInLeft');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '1s');
    arr[i].setAttribute('data-wow-offset', '100');
    arr[i].setAttribute('data-wow-iteration', '2');
  }</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><!-- hexo injector body_end end --></body></html>